<!DOCTYPE html>
<html>
  <head>
    <title>Embedding Vega-Lite</title>
    <script src="https://cdn.jsdelivr.net/npm/vega@5.20.2"></script>
    <script src="https://cdn.jsdelivr.net/npm/vega-lite@5.1.1"></script>
    <script src="https://cdn.jsdelivr.net/npm/vega-embed@6.18.2"></script>
  </head>
  <body>
    <div id="vis"></div>
	<div>
	  <button id="render">Render</button>
	  <button id="random_add">Random Add</button>
	  <button id="random_del">Random Del</button>
	  <button id="scale">Scale x10</button>
	  <button id="circle">Change to Circle</button>
	</div>

    <script type="text/javascript">
      var vlSpec ={
					  "$schema": "https://vega.github.io/schema/vega-lite/v5.json",
					  "data": {"url": "building_inventory.csv"},
					  "vconcat": [
						{
						  "mark": {"type": "circle", "clip": true},
						  "selection": {"clickanddrag": {"type": "interval", "encodings": ["y"]}},
						  "transform": [
							{"filter": {"field": "Year Acquired", "gt": 1990}},
							{"filter": {"field": "Congress Dist", "gt": 0}}
						  ],
						  "encoding": {
							"x": {
							  "field": "Year Acquired",
							  "type": "quantitative",
							  "scale": {"domain": [1990, 2019]}
							},
							"y": {"field": "Square Footage", "type": "quantitative"},
							"tooltip": [
							  {"field": "County", "type": "nominal"},
							  {"field": "City", "type": "nominal"}
							],
							"opacity": {"condition": {"selection": "clickanddrag"}, "value": 0.2}
						  }
						},
						{
						  "layer": [
							{
							  "mark": "bar",
							  "transform": [{"filter": {"field": "Year Acquired", "gt": 1990}}, {"filter": {"field": "Congress Dist", "gt": "0"}}],
							  "encoding": {
								"x": {"field": "Congress Dist", "type": "ordinal"},
								"y": {"aggregate": "count", "type": "quantitative"},
								"opacity": {"value": 0.2}
							  }
							},
							{
							  "mark": "bar",
							  "transform": [{"filter": {"selection": "clickanddrag"}}, {"filter": {"field": "Congress Dist", "gt": "0"}}],
							  "encoding": {
								"x": {"field": "Congress Dist", "type": "ordinal"},
								"y": {"aggregate": "count", "type": "quantitative"}
							  }
							}
						  ]
						}
					  ]
					};
					
	  var embed = {};
	  document.getElementById("render").addEventListener("click", (event) => {embed = vegaEmbed("#vis", vlSpec)});
			   
	  document.getElementById("random_del").addEventListener("click", (event) => { var cs = embed.view.changeset().remove((d) => {return d;});
      embed.view.change("source_0", cs).run();
})

    </script>
  </body>
</html>
